<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="apple-mobile-web-app-title" content="CapMask">
    <title>CapMask</title>
    <link rel="icon" type="h/png" href="h.png">
<link rel="apple-touch-icon" href="h.png">
    <style>
        body { 
            font-family: 'Kanit', sans-serif; 
            text-align: center; 
            /* ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏î‡∏∂‡∏á‡∏£‡∏π‡∏õ‡∏ä‡∏∑‡πà‡∏≠ "‡∏ï‡∏£‡∏ß‡∏à" ‡∏°‡∏≤‡πÉ‡∏ä‡πâ (‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡πÑ‡∏ü‡∏•‡πå ‡πÄ‡∏ä‡πà‡∏ô .png ‡∏´‡∏£‡∏∑‡∏≠ .jpg) */
            background: #fae2aa url('‡∏ï‡∏£‡∏ß‡∏à.png') no-repeat center center fixed;
            background-size: cover;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        h2 {
            color: #d35400; 
            margin-top: 50px;
            font-size: 28px;
            background: rgba(253, 152, 248, 0.8);
            padding: 10px 20px;
            border-radius: 15px;
        }

        .btn-start {
            background-color: #2980b9;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            margin: 20px 0;
            transition: 0.3s;
        }

        #webcam-container { 
            border: 10px solid #ffffff; 
            width: 300px;
            height: 300px;
            border-radius: 30px; 
            overflow: hidden; 
            background: #000;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        #label-container { 
            margin-top: 20px; 
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .result-box { 
            padding: 15px; 
            width: 250px;
            border-radius: 15px; 
            font-size: 22px; 
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        .mask { background-color: #27ae60; border: 3px solid #1e8449; }
        .no-mask { background-color: #c0392b; border: 3px solid #922b21; }
    </style>
</head>
<body>

    <h2>‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏ß‡∏°‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏≤‡∏Å‡∏≠‡∏ô‡∏≤‡∏°‡∏±‡∏¢</h2>
    
    <button class="btn-start" type="button" onclick="init()">
        üì∏ ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡πÅ‡∏Å‡∏ô
    </button>
    
    <div id="webcam-container"></div>
    <div id="label-container"></div>

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>

    <script type="text/javascript">
        // ‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡πÉ‡∏™‡πà‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏à‡∏£‡∏¥‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å Teachable Machine ‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö
        const URL = "https://teachablemachine.withgoogle.com/models/Cb4LgUU4b/"; 

        let model, webcam, labelContainer, maxPredictions;

        async function init() {
            const modelURL = URL + "model.json";
            const metadataURL = URL + "metadata.json";

            try {
                model = await tmImage.load(modelURL, metadataURL);
                maxPredictions = model.getTotalClasses();

                const flip = true; 
                webcam = new tmImage.Webcam(300, 300, flip);
                await webcam.setup(); 
                await webcam.play();
                window.requestAnimationFrame(loop);

                document.getElementById("webcam-container").innerHTML = "";
                document.getElementById("webcam-container").appendChild(webcam.canvas);
                labelContainer = document.getElementById("label-container");
                labelContainer.innerHTML = ""; 
                for (let i = 0; i < maxPredictions; i++) {
                    labelContainer.appendChild(document.createElement("div"));
                }
            } catch (e) {
                alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå Model ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏Ñ‡∏£‡∏±‡∏ö");
            }
        }

        async function loop() {
            webcam.update();
            await predict();
            window.requestAnimationFrame(loop);
        }

        async function predict() {
            const prediction = await model.predict(webcam.canvas);
            for (let i = 0; i < maxPredictions; i++) {
                const className = prediction[i].className;
                const probability = (prediction[i].probability * 100).toFixed(2);
                
                const displayLabel = className === "MASK" ? "MASK" : "NO MASK";
                const colorClass = className === "MASK" ? "mask" : "no-mask";

                labelContainer.childNodes[i].innerHTML = `
                    <div class="result-box ${colorClass}">
                        ${displayLabel}: ${probability}%
                    </div>`;
            }
        }
    </script>
</body>

</html>

